<!DOCTYPE html>
<html>
<head>
  <title></title>
  <style>

  body {
    margin : 0px;
    padding : 0px;
  }

  .box {
    background-color:#eee;
    /*border : 1px solid #ddd;*/
    width:20px;
    height: 20px;
    top:20px;
    position: absolute;
  }

  .path {
    width: 100%;
    height: 39px;
    border-bottom: 1px solid #bbb;
  }

  .shoot{

    width : 20px;
    height : 20px;
    background-color:red;
    position:absolute;
    top: 2000px;
    left : 400px;
    border-radius: 3px;
    opacity: 0.8; 
  }

  .crashed {
    background-color:#bb0000;
  }

  .message {
    position: absolute;
    text-align: center;
    width: 100%;
    color: white;
    top: 200px;
    font-family: 'Arial';
  }

  </style>
</head>
<body>

<div class="message"><h1>Game over</h1></div>

<div class="path">

  <div class="box"></div>

</div>


<script>

function randomizer(max) {
  return Math.floor(Math.random() * max);
}

function multipleOf10 (number) {
	return Math.floor(number/10) * 10;
}

var Shooter = function (containerSelector,gameObj) {

  this.x = multipleOf10(randomizer(1200));
  this.y = multipleOf10(window.innerHeight);
  this.speed = 80;

  this.element = document.createElement("div");
  this.element.className = "shoot";
  document.querySelector(containerSelector).appendChild(this.element);  

  this.element.style.left = this.x + "px";
  this.element.style.top  = this.y + "px";

  this.timer = null;

  this.fireIt = function() {
    var that = this;
    this.timer = setInterval(function() {
      that.moveUp();
    },this.speed);

  }

  this.moveUp = function() {
    this.element.style.top = (this.y -= 10) + "px";

    if (this.y <= 40) {
      clearInterval(this.timer);
      gameObj.checkEnd(this);
    }
  } 
  
  this.fireIt();
  
}

var Box = function () {
  
  this.x = 10;
  this.element = document.querySelector(".box");
  this.element.style.left   = this.x + "px";
  
  this.moveLeft = function () {
  	this.element.style.left = (this.x -= 10) + "px";
  }
  
  this.moveRight = function () {
  	this.element.style.left = (this.x += 10) + "px"; 
  }
}


var Game = function () {

	var gameObj = this;

	this.box = new Box();

	this.gameTimer = setInterval(function() {
	  new Shooter("body",gameObj);  
	},3000);

	this.gameOver = function() {
		clearInterval(this.gameTimer);
  	document.body.className = "crashed";
	}

	this.checkEnd = function(shooterElement) {
		if(shooterElement.x != this.box.x)
			this.gameOver();
	}

	this.setKeyboardListener = function() {
		
		var that = this;

		document.body.addEventListener("keydown", function(event) {
		  if(event.keyCode === 39 )
			  that.box.moveRight(); 
		  else  if(event.keyCode === 37) 
		    that.box.moveLeft();
		});
	};

	this.setKeyboardListener();

}

var myGame = new Game ();


</script>

</body>
</html>